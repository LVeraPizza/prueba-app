<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pedidos</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
    <script type="text/javascript">
        (function () {
            emailjs.init("wGGXbjw0SnUFnyV2T");
        })();
    </script>
    <style>
        body {
            height: 100%;
            /* Asegura que el html y el body ocupen el 100% de la altura de la ventana */
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: rgba(0, 0, 0, 0.8);
            /* Fondo negro semitransparente */
            background-image: url('css/fondo.jpg');
            /* Ruta de la imagen de fondo */
            background-size: cover;
            /* La imagen ocupa todo el fondo */
            background-position: center;
            /* Centra la imagen */
            background-repeat: no-repeat;
            /* Evita que la imagen se repita */
            background-attachment: fixed;
            /* Hace que el fondo quede fijo */
        }

        #form-container {
            max-width: 600px;
            /* Ancho máximo del contenedor */
            margin: auto;
            /* Centrar el contenedor */
            padding: 20px;
            /* Espaciado interno */
            background-color: rgba(19, 18, 18, 0.8);
            /* Fondo blanco semitransparente */
            border: 1px solid rgba(14, 13, 13, 0.5);
            /* Borde gris claro semitransparente */
            border-radius: 8px;
            /* Bordes redondeados */
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            /* Sombra */
            margin-top: 100px;
        }


        h1 {
            text-align: center;
            /* Centra el título */
            color: white;
        }

        .form-section {
            margin: 20px 0;
        }

        .form-section label {
            font-size: 1.1em;
            color: white;
            margin-bottom: 10px;
            display: block;
            text-align: center;
        }

        #delivery {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            color: #333;
            background-color: #f9f9f9;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0px 2px 4px rgba(0, 0, 0, 0.1);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            appearance: none;
            /* Elimina la flecha por defecto */
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="gray"><path d="M7 10l5 5 5-5z"/></svg>');
            background-repeat: no-repeat;
            background-position: right 10px center;
        }

        #delivery:focus {
            border-color: #0073e6;
            box-shadow: 0px 0px 5px rgba(0, 115, 230, 0.5);
            outline: none;
        }

        .form-section select option {
            color: #333;
        }

        /* Opcional: animación para el cambio de opciones */
        #delivery-options {
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        #delivery-options:hover {
            background-color: #f0f0f0;
            cursor: pointer;
        }


        label {
            display: block;
            /* Cada etiqueta ocupa una línea */
            margin-bottom: 5px;
            /* Espacio debajo de las etiquetas */
        }

        input[type="text"],
        input[type="tel"] {
            width: 95%;
            /* Ocupa el 100% del contenedor */
            padding: 8px;
            /* Espaciado interno */
            border: 1px solid #ccc;
            /* Borde gris */
            border-radius: 4px;
            /* Bordes redondeados */
        }


        button {
            width: 100%;
            /* Ocupa el 100% del contenedor */
            padding: 10px;
            /* Espaciado interno */
            font-size: 16px;
            /* Tamaño de fuente */
            font-weight: bold;
            /* Negrita */
            color: white;
            /* Color del texto */
            background-color: green;
            /* Color de fondo verde */
            border: none;
            /* Sin borde */
            border-radius: 5px;
            /* Bordes redondeados */
            cursor: pointer;
            /* Cambia el cursor al pasar por encima */
        }

        button:hover {
            background-color: darkgreen;
            /* Color de fondo al pasar el mouse */
        }

        footer {
            position: fixed;
            /* Hace que el footer esté fijo en la parte inferior */
            bottom: 0;
            /* Alinea el footer a la parte inferior de la ventana */
            left: 0;
            /* Alinea el footer al lado izquierdo de la ventana */
            background-color: white;
            color: white;
            display: flex;
            justify-content: center;
            /* Centra los logos en el footer */
            align-items: center;
            /* Centra los logos verticalmente */
            width: 100%;
            /* Asegura que el footer ocupe todo el ancho de la página */
            z-index: 1000;
            /* Asegura que el footer esté por encima de otros elementos */
            border-top: 2px solid black;
            /* Agrega una línea negra de 2px en la parte superior */
        }

        footer img {
            width: 50px;
            /* Ancho de los logos */
            height: auto;
            /* Mantiene la proporción */
            margin: 10px 5px;
            /* Espacio entre los logos (10px arriba y abajo, 15px a los lados) */
            background-color: white;
            /* Color de fondo para visualizar el espacio */
        }

        .separator {
            width: 1px;
            /* Ancho de la barra */
            height: 50px;
            /* Altura de la barra */
            background-color: rgb(10, 10, 10);
            /* Color de la barra */
            margin: 0 10px;
            /* Espacio a los lados de la barra */
        }
    </style>
</head>

<body>
    <div id="form-container">
        <h1>¡Estas a un paso!</h1>

        <div class="form-section">
            <label for="name">Nombre:</label>
            <input type="text" id="name" name="name" required placeholder="Escribe tu nombre">
        </div>

        <div class="form-section">
            <label for="address">Dirección:</label>
            <input type="text" id="address" name="address" required placeholder="Escribe la dirección">
        </div>

        <div class="form-section">
            <label for="phone">Número de Teléfono:</label>
            <input type="tel" id="phone" name="phone" pattern="[0-9]{10}" required placeholder="Escribe tu número">
        </div>


        <div class="form-section">
            <label for="delivery">Opciones de Entrega:</label>
            <select id="delivery" name="delivery" required>
                <option value="" disabled selected>Selecciona una opción</option>
                <option value="retiro">Retiro</option>
                <option value="envio">Envío</option>
            </select>
        </div>


        <button id="submit-button">Enviar</button>
    </div>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Inicializar EmailJS
            (function () {
                emailjs.init("wGGXbjw0SnUFnyV2T"); // Reemplaza con tu User ID de EmailJS
            })();

            // Función para manejar el envío del formulario
            document.getElementById('submit-button').addEventListener('click', function (event) {
                event.preventDefault(); // Evita que el formulario se envíe de manera predeterminada

                // Obtener los valores de los campos
                const name = document.getElementById('name').value;
                const address = document.getElementById('address').value;
                const phone = document.getElementById('phone').value;
                const deliveryOption = document.querySelector('select[name="delivery"]').value;


                // Calcular el costo total
                let deliveryCost = 0;
                if (deliveryOption === "envio") {
                    deliveryCost = 1000; // Agregar costo de envío
                }

                // Obtener los productos del carrito (esto es un ejemplo)
                const cart = loadCart();
                const cartItems = Object.entries(cart).map(([productName, { price, quantity }]) => {
                    return `${productName}: ${quantity} x $${price} = $${price * quantity}`;
                }).join('\n');

                // Calcular el total
                const totalAmount = Object.values(cart).reduce((sum, product) => sum + (product.price * product.quantity), 0) + deliveryCost;

                // Enviar el correo
                emailjs.send("service_6kjxjnj", "template_o8vfdnl", {
                    from_name: name,
                    to_name: "La Vera Pizza",
                    address: address,
                    phone: phone,
                    deliveryOption: deliveryOption,
                    deliveryCost: deliveryCost,
                    cartItems: cartItems,
                    totalAmount: totalAmount,
                })
                    .then(function (response) {
                        console.log('Éxito!', response.status, response.text);

                        // Redirigir a gracias.html
                        window.location.href = 'gracias.html';
                    }, function (error) {
                        console.log('Error al enviar el correo:', error);
                        alert("Error al enviar el formulario, por favor intenta nuevamente.");
                    });
            });

            // Función para cargar el carrito desde localStorage
            function loadCart() {
                const storedCart = localStorage.getItem('cart');
                if (storedCart) {
                    return JSON.parse(storedCart);
                }
                return {};
            }
        });



    </script>
</body>

<footer>
    <a href="index.html">
        <img src="img/casa.png" alt="Logo 1">
    </a>
    <div class="separator"></div>

    <a href="contacto.html">
        <img src="img/redes-sociales.png" alt="Logo 2">
    </a>
    <div class="separator"></div>

    <a href="promociones.html">
        <img src="img/promocion.png" alt="Logo 3">
    </a>
    <div class="separator"></div>

    <a href="productos-ventas.html">
        <img src="img/pizza.png" alt="Logo 4">
    </a>
    <div class="separator"></div>

    <a href="carrito.html">
        <img src="img/carrito-de-compras.png" alt="Logo 5">
    </a>
</footer>

</html>